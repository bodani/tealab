Search.setIndex({"docnames": ["config", "demo", "dev_list", "etcd", "index", "install-tea", "loki", "memcached", "minio", "mirror", "monitor", "node", "patroni", "postgresql", "preface", "redis", "redis_cluster", "repmgr"], "filenames": ["config.md", "demo.md", "dev_list.md", "etcd.md", "index.rst", "install-tea.md", "loki.md", "memcached.md", "minio.md", "mirror.md", "monitor.md", "node.md", "patroni.rst", "postgresql.md", "preface.md", "redis.md", "redis_cluster.md", "repmgr.md"], "titles": ["\u914d\u7f6e\u8bf4\u660e", "\u5feb\u901f\u5f00\u59cb", "\u5f00\u53d1\u8ba1\u5212\u5217\u8868 \u529f\u80fd\u7c7b", "etcd\u96c6\u7fa4\u7ba1\u7406", "tea", "\u5b89\u88c5tealabs", "Loki \u65e5\u5fd7\u7ba1\u7406", "memcached \u7ba1\u7406", "minio\u96c6\u7fa4\u7ba1\u7406", "\u642d\u5efayum\u6e90", "\u76d1\u63a7\u670d\u52a1", "\u670d\u52a1\u5668\u7ba1\u7406", "patroni \u7ba1\u7406", "Postgresql\u96c6\u7fa4\u7ba1\u7406", "\u524d\u8a00", "redis\u9ad8\u53ef\u7528", "Redis \u96c6\u7fa4", "repmgr\u7ba1\u7406"], "terms": {"vim": [1, 3, 5, 9], "host": [1, 3, 5, 7, 8, 9, 10, 11, 12, 15, 16, 17], "ini": [0, 1, 3, 5, 7, 8, 9, 10, 11, 12, 15, 16], "node": [0, 1, 5, 8, 10, 11, 14, 17], "10": [0, 1, 3, 5, 7, 8, 10, 11, 12, 13, 15, 16, 17], "14": [0, 1, 3, 5, 8, 10, 11, 12, 13, 15, 16, 17], "ansibl": [0, 1, 2, 5, 7, 8, 9, 14, 15, 16], "playbook": [1, 3, 5, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17], "create_us": [0, 1, 5], "yml": [1, 3, 5, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17], "root": [1, 5, 8], "shell": [1, 5, 14], "whoami": [1, 5], "tea": [0, 1, 2, 3, 5, 8, 10, 11], "repo": [0, 1, 5, 9], "use_repo": 1, "vi": [1, 5, 17], "conf": [1, 3, 7, 8, 12, 13, 15, 16, 17], "ip": [1, 15, 17], "create_nginx": 1, "yaml": 2, "prometheus": [0, 2, 9, 10, 14], "grafana": [0, 2, 10, 14], "altermanag": [2, 10], "export": [2, 9, 10, 14], "load": [2, 3], "dashboard": 2, "rule": 2, "loki": [0, 2, 14], "promtail": 2, "python": 2, "docker": [0, 2, 5, 14], "imag": 2, "click": 2, "https": [0, 3, 5, 8, 9, 10, 13, 15, 17], "io": [3, 9, 15], "doc": [0, 3, 10, 15, 17], "v3": 3, "op": 3, "guid": 3, "hardwar": 3, "version": [0, 3, 5, 12], "11": [0, 3, 5, 8, 11, 12, 13, 15, 16, 17], "12": [0, 3, 5, 7, 8, 11, 12, 13, 15, 16, 17], "13": [0, 3, 5, 7, 8, 11, 12, 13, 15, 16, 17], "var": [0, 3, 5, 7, 8, 10, 12, 13, 15, 16, 17], "name": [3, 9, 15], "cluster01": 3, "etcd_data_dir": [0, 3], "lib": [0, 3, 12, 13, 15, 16, 17], "wal": [0, 3, 14], "etcd_wal_dir": [0, 3], "etcd_peer_port": [0, 3], "2380": [0, 3], "etcd_client_port": [0, 3], "2379": [0, 3, 12], "local_etcd_backup_data": 3, "tmp": [0, 3], "db": 3, "create_etcd": 3, "add_etcd": 3, "id": [3, 8], "etcdctl": 3, "member": 3, "list": [3, 5, 12], "tabl": 3, "status": [3, 8], "peer": 3, "addr": 3, "client": 3, "is": [3, 4, 15, 16], "learner": 3, "de875c7a56a96ba": 3, "start": 3, "fals": [3, 8, 12, 17], "57a1101668dd9764": 3, "5f0749d4389084c1": 3, "7cebb079e53fc9e7": 3, "remov": 3, "data": [0, 3, 9, 10, 12, 13, 17], "dir": [3, 15, 16], "move": 3, "snapshot": 3, "save": [3, 16], "etcd_data_backup": 3, "s3": [3, 8], "restore_etcd": 3, "etcdctl_api": 3, "make": 3, "mirror": [3, 8, 9], "option": 3, "destin": 3, "flag": [3, 15], "no": [3, 16], "dest": 3, "prefix": 3, "true": [3, 12, 13, 17], "endpoint": [3, 8], "xxxx": 3, "insecur": 3, "skip": 3, "tls": 3, "verifi": 3, "v2": 3, "ttl": [3, 12], "check": 3, "perf": [3, 8], "binari": 3, "upgrade_etcd": 3, "authent": 3, "rbac": 3, "an": [4, 14], "easi": [4, 14], "autom": [4, 14], "tool": [4, 8, 14], "postgr": [4, 12, 13, 17], "what": 4, "whi": 4, "philosophi": 4, "tealab": [0, 4, 9], "etcd": [0, 4, 12, 14], "leader": [4, 12], "todo": [4, 5], "minio": [4, 14], "tag": [4, 5, 7, 15, 17], "redi": [4, 14], "sentinel": [4, 16], "memcach": 4, "ansbil": 5, "yum": 5, "instal": [5, 7, 8, 9], "epel": 5, "releas": [5, 9], "git": 5, "curl": [5, 8], "sshpass": 5, "27": 5, "useradd": 5, "home": [5, 8], "passwd": 5, "sudo": [5, 9, 17], "all": [0, 5, 15, 16], "nopasswd": 5, "visudo": 5, "ssh": 5, "key": [5, 8, 12], "su": [5, 17], "keygen": 5, "rsa": 5, "ls": 5, "clone": 5, "github": 5, "com": [0, 5, 8, 10, 15], "bodani": 5, "gite": 5, "zhangeamon": [0, 5, 9, 10], "cd": [5, 9], "usernam": [0, 5, 17], "local": [0, 5, 8], "local_bin": [0, 5], "yournam": 5, "disable_rootlogin": 5, "privat": [0, 5], "test": [0, 5], "vvv": 5, "download": [5, 8], "prepar": [5, 8], "xxx": [5, 17], "tealab_packag": 5, "packag": [5, 9], "go": 5, "memcached_port": 7, "11211": 7, "memcached_us": 7, "memcached_maxconn": 7, "1024": 7, "mb": 7, "memcached_caches": 7, "64": 7, "memcached_opt": 7, "create_memcac": 7, "monitor": [0, 7, 8, 10, 11, 15], "tar": 8, "bin": [8, 12], "zxf": 8, "children": 8, "pool1": 8, "minio_ser_bin_loc": 8, "usr": [8, 12], "node_dir": 8, "mnt": 8, "minio1": 8, "minio2": 8, "minio_root_us": 8, "minio_root_password": 8, "f447b20a7fcbf53a5d5be013ea0b15af": [8, 15, 16], "minio_ser_port": 8, "9000": 8, "ui": 8, "minio_conl_port": 8, "9001": 8, "minio_mc_alia": 8, "myminio": 8, "node_host": 8, "minio3": 8, "minio4": 8, "pool": 8, "minio_volum": 8, "http": [8, 10, 11], "sidekick": 8, "gateway": 8, "minio_lb_ser_port": 8, "9009": 8, "sidekick_backend": 8, "tea_ctl": 8, "creat": [8, 12, 16, 17], "destori": 8, "volum": 8, "mc": 8, "admin": [0, 8, 10, 15], "decommiss": 8, "capac": 8, "1st": 8, "73": 8, "mib": 8, "use": [8, 15, 16], "120": 8, "gib": 8, "total": 8, "activ": 8, "2nd": 8, "create_minio": 8, "info": [8, 15], "need": 8, "regist": 8, "support": [8, 14], "object": 8, "durat": 8, "20s": 8, "size": 8, "128mib": 8, "benchmark": 8, "warp": 8, "mix": 8, "access": 8, "secret": 8, "concurr": 8, "30": [8, 12], "obj": 8, "500k": 8, "get": [8, 12], "distrib": 8, "stat": 8, "put": 8, "delet": 8, "autoterm": 8, "zhuanlan": 8, "zhihu": 8, "600295425": 8, "srccluster": 8, "bucket": 8, "destclust": 8, "rclone": 8, "type": [8, 15], "provid": 8, "env_auth": 8, "access_key_id": 8, "secret_access_key": 8, "12345678": 8, "region": 8, "lsd": 8, "mkdir": 8, "sync": [8, 15], "file": [0, 8, 9], "upgrad": [8, 15], "80": [9, 15], "repo_address": 9, "top": [0, 9, 10], "repo_ip": 9, "192": 9, "168": 9, "15": 9, "repo_port": 9, "role": [9, 15], "default": [0, 9, 12, 13, 17], "main": 9, "repo_path": 9, "url": 9, "rpm": 9, "repo_url_packag": 9, "repo_packag": 9, "cat": 9, "baseurl": 9, "packagecloud": 9, "el": 9, "releasev": 9, "basearch": 9, "gpgcheck": 9, "and": [9, 12, 14], "create_repo": 9, "downloadon": 9, "downloaddir": 9, "base": 9, "new_need_add": 9, "repotrack": 9, "new_need_add_": 9, "xml": 9, "createrepo": 9, "idc": [0, 10, 11], "blackbox": [10, 14], "9090": 10, "3000": [10, 11], "9093": 10, "node_export": [10, 11], "9100": [10, 11], "blackbox_export": [10, 11], "9115": [10, 11], "path": [0, 10], "prometheus_data_path": [0, 10], "grafana_admin_usernam": [0, 10], "grafana_admin_password": [0, 10], "domain_http": [0, 10], "www": [0, 10], "baidu": [0, 10], "hostnam": [0, 11, 17], "control": 0, "first": [0, 11], "node1": [0, 11], "node2": [0, 11], "node3": [0, 11], "harden": [], "linux": [14, 15], "cento": 14, "ubuntu": 14, "debian": 14, "nginx": [0, 14], "haproxi": 14, "kafka": 14, "rabbitmq": 14, "repmgr": [4, 14], "patroni": [4, 14], "pgbouncer": [13, 14], "citus": 14, "debezium": 14, "k3s": 14, "habor": 14, "filebeat": 14, "logstash": 14, "elasticsearch": 14, "zabbix": 14, "sentri": 14, "gitea": 14, "dns": 14, "everi": 14, "administr": 14, "at": 14, "some": 14, "point": 14, "reach": 14, "threshold": 14, "when": 14, "manual": [14, 15], "mainten": 14, "of": [12, 14], "cluster": [14, 16, 17], "becom": 14, "arduous": 14, "chore": 14, "the": [12, 14, 15, 16], "necess": 14, "solut": 14, "more": 14, "appar": 14, "here": 14, "will": [12, 14], "be": 14, "discuss": 14, "exampl": 14, "such": 14, "simpl": 14, "power": 14, "process": [12, 14], "should": 14, "obvious": 14, "coher": 14, "uniform": 14, "complex": 14, "instruct": 14, "custom": 14, "script": 14, "which": 14, "are": 14, "never": 14, "tribal": 14, "knowledg": 14, "minim": 14, "world": 14, "beauti": 14, "becaus": 14, "simplic": 14, "have": 14, "cup": 14, "wait": 14, "for": [12, 14], "moment": 14, "everyth": 14, "accomplish": 14, "way": 14, "you": 14, "expect": 14, "it": [12, 14], "to": [12, 14, 15, 16, 17], "swap": 15, "cpu": 15, "6379": [15, 16], "26379": [15, 16], "redis_export": 15, "9121": 15, "master": 15, "has": 15, "persist": 15, "enabl": 15, "redis_rol": 15, "master_groupnam": 15, "mymaster001": 15, "quorum": [15, 16], "replicaof": [13, 15, 17], "replica_prior": 15, "100": [15, 16], "redis_sentinel": [15, 16], "redis_port": [15, 16], "redis_password": [15, 16], "bind": [15, 16], "min": [15, 16], "replica": [12, 15, 16], "write": [15, 16], "max": [15, 16], "lag": [15, 16], "maxmemori": [15, 16], "10gb": [15, 16], "evict": [15, 16], "allkey": [15, 16], "lfu": [15, 16], "sentinel_port": [15, 16], "sentinel_password": [15, 16], "onli": [15, 16], "detect": [15, 16], "failur": [15, 16], "down": 15, "after": 15, "millisecond": [15, 16], "1000": [15, 16], "60": [15, 16], "failov": [4, 15, 17], "timeout": [12, 15], "180": [15, 16], "parallel": 15, "sentinel_dir": [15, 16], "create_redi": 15, "cli": [15, 16], "127": [15, 16], "auth": 15, "ok": 15, "replic": [12, 15, 17], "connected_slav": 15, "slave0": 15, "port": [15, 17], "state": 15, "onlin": 15, "offset": 15, "1548116": 15, "slave1": 15, "runid": 15, "820a82215c08d11bbc0cbabe8061a460cd50c6f6": 15, "slave": 15, "shake": 15, "help": 15, "aliyun": 15, "document": 15, "detail": 15, "111066": 15, "html": [15, 17], "or": [12, 15], "restart": 15, "instanc": 15, "without": 15, "downtim": 15, "redis_clust": 16, "rdb": 16, "aof": 16, "preambl": 16, "yes": 16, "3600": 16, "300": 16, "10000": 16, "appendon": 16, "appendfilenam": 16, "appenddirnam": 16, "appendonlydir": 16, "everysec": 16, "alway": 16, "appendfsync": 16, "no_appendfsync_on_rewrit": 16, "auto_aof_rewrite_percentag": 16, "auto_aof_rewrite_min_s": 16, "64mb": 16, "aof_load_trunc": 16, "aof_use_rdb_preambl": 16, "aof_timestamp_en": 16, "aof_rewrite_incremental_fsync": 16, "down_after_millisecond": 16, "failover_timeout": 16, "parallel_sync": 16, "cluster_en": 16, "cluster_node_timeout": 16, "cluster_migration_barri": 16, "cluster_require_full_coverag": 16, "cluster_allow_reads_when_down": 16, "redis_cluster_replica": 16, "7000": 16, "7001": 16, "7002": 16, "7003": 16, "7004": 16, "7005": 16, "create_redis_clust": 16, "second": [0, 11, 12], "node4": [0, 11], "firewalld": 2, "log": 0, "ro": [], "logrota": [], "logrot": 2, "aser": [], "assert": 2, "kgithub": 5, "postgresql": [4, 12, 17], "application_nam": [12, 13, 17], "node11": [13, 17], "node12": [13, 17], "node13": [13, 17], "node14": [13, 17], "pg_cluster_nam": [12, 13, 17], "batman001": [13, 17], "pg_version": [12, 13, 17], "pg_data": [12, 13, 17], "pgsql": [12, 13, 17], "rep_us": [12, 13, 17], "repus": 13, "rep_password": [12, 13, 17], "123456": [13, 17], "use_slot": [13, 17], "install_pgbounc": [13, 17], "pgtune": [13, 17], "leopard": [13, 17], "in": [12, 13, 17], "ua": [13, 17], "create_postgresql": 13, "node_id": [12, 17], "master_min_child_nod": 17, "ctl": [], "rejoin": 17, "dbname": 17, "user": [0, 12, 17], "forc": 17, "rewind": 17, "dri": 17, "run": 17, "share": [], "preload": [], "librari": [], "set": 17, "password": [12, 17], "encrypt": [0, 12, 17], "scram": 17, "sha": 17, "256": 17, "login": 17, "superus": [12, 17], "alter": 17, "search": [], "public": 17, "databas": 17, "owner": 17, "pgpass": 17, "5432": 17, "chmod": 17, "0600": 17, "pg": [12, 17], "hba": 17, "recoveri": 17, "applic": [], "show": [12, 17], "standbi": 17, "switchov": [12, 17], "repmgrd": 4, "pwd123456": 17, "shared_preload_librari": 17, "repmgr_ctl": 17, "prepare_pg_manu": 17, "password_encrypt": 17, "search_path": 17, "node_nam": 17, "create_pgha_repmgr": 17, "pgha_repmgr": 17, "case": 4, "org": 17, "quickstart": 17, "configur": 17, "etc": 0, "servic": 0, "loki_data_path": 0, "retention_period": 0, "2520h": 0, "other": 0, "server": 0, "json": 0, "log_driv": 0, "etcd_nam": [0, 12], "etcd001": [0, 12], "ectd": 0, "ectd_cert_dir": 0, "ssl": 0, "cert": 0, "etcd_local_backup_dir": 0, "vault": 0, "edit": [0, 12], "decrypt": 0, "demo": [], "reolic": 17, "domain": [], "retent": [], "period": [], "driver": [], "backup": [], "definit": 0, "mo": [], "ot": [], "patroni_superuser_usernam": 12, "with": 12, "patroni_superuser_password": 12, "patroni_replication_usernam": 12, "patroni_replication_password": 12, "supperus": 12, "pg_rewind": 12, "rewind_usernam": 12, "rewind_password": 12, "grant": 12, "execut": 12, "on": 12, "function": 12, "pg_catalog": 12, "pg_ls_dir": 12, "text": 12, "boolean": 12, "pg_stat_fil": 12, "pg_read_binary_fil": 12, "bigint": 12, "patroni_cluster_a1": 12, "node31": 12, "node32": 12, "node33": 12, "is_lead": 12, "clone_from": 12, "pg_cluster001": 12, "etcd_host": 12, "etcd_usernam": 12, "etcd_us": 12, "etcd_password": 12, "post": 12, "requst": 12, "safe": 12, "rest_api_usernam": 12, "myuser": 12, "rest_api_password": 12, "mypassword": 12, "pg_bin": 12, "pg_config": 12, "sup_us": 12, "sup_password": 12, "superpassword": 12, "pg_monitor": [], "mon_us": [], "tea_mon": [], "rewind_us": 12, "dc": [], "dcs": 4, "peiz": [], "create_pgha_patroni": 12, "pgha_patroni": [], "server_nam": 12, "patronictl": 12, "swi": [], "swithov": 12, "paus": 12, "resum": 12, "config": 12, "loop_wait": 12, "retry_timeout": 12, "loop": 12, "retri": 12, "number": 12, "sleep": 12, "valu": 12, "acquir": 12, "lock": 12, "think": 12, "as": 12, "length": 12, "time": 12, "befor": 12, "initi": 12, "automat": 12, "oper": 12, "network": 12, "issu": 12, "shorter": 12, "than": 12, "this": 12, "not": 12, "caus": 12, "demot": 12, "rest": [], "restapi": 12, "primari": [], "nofailov": 12, "noloadbal": 12, "clonefrom": 12, "clone_form": 12, "nosync": 12, "200": 12, "pg_": [], "pg_rewar": [], "pg_rewarm": 12, "return": [], "code": [], "readinessprob": [], "httpget": [], "scheme": [], "readi": [], "8008": [], "initialdelaysecond": [], "periodsecond": [], "timeoutsecond": [], "successthreshold": [], "failurethreshold": [], "livenessprob": [], "live": [], "pg_hba": 12, "patroni02": [], "id3": [], "ref": []}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"nginx": 1, "node": 2, "etcd": 3, "leader": 3, "todo": 3, "tea": [4, 14], "tealab": 5, "memcach": 7, "minio": 8, "tag": [8, 12], "yum": 9, "postgr": 14, "what": 14, "is": 14, "whi": 14, "philosophi": 14, "redi": [15, 16], "sentinel": 15, "postgresql": 13, "repmgr": 17, "repmgrd": 17, "loki": 6, "case": 17, "demo": [], "create_us": [], "prometheus": [], "data": [], "path": [], "other": [], "server": [], "default": [], "json": [], "file": [], "version": [], "10": [], "14": [], "ectd": [], "wal": [], "patroni": 12, "dc": [], "dcs": 12, "peiz": [], "failov": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})